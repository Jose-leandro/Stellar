# Get the current branch name
BRANCH_NAME=$(git symbolic-ref --short HEAD)

EXPECTED_REMOTE_URL="https://github.com/Jose-leandro/Stellar.git"

# Retrieve the remote URL of the current repository
REMOTE_URL=$(git config --get remote.origin.url)

# Function to print a message and exit with a status code
abort_with_message() {
  echo "$1"
  exit "$2"
}

# Check if the current remote URL matches the expected URL
if [ "$REMOTE_URL" = "$EXPECTED_REMOTE_URL" ]; then
  echo "Remote URL matches. Proceeding with safe actions."

  # Check if the branch is a feature branch
  if echo "$BRANCH_NAME" | grep -q "^feature/"; then
    echo "Feature branch detected. Automatically pushing changes."
    git push "$EXPECTED_REMOTE_URL" "$BRANCH_NAME"
    exit 0

  # Check if the branch is a bugfix branch
  elif echo "$BRANCH_NAME" | grep -q "^bugfix/"; then
    echo "Bugfix branch detected. Automatically pushing changes."
    git push "$EXPECTED_REMOTE_URL" "$BRANCH_NAME"
    exit 0

  # Check if the branch is a hotfix branch
  elif echo "$BRANCH_NAME" | grep -q "^hotfix/"; then
    echo "Hotfix branch detected. Pushing changes to remote."
    git push "$EXPECTED_REMOTE_URL" "$BRANCH_NAME"
    exit 0

  else
    abort_with_message "This branch does not match the feature/, bugfix/, or hotfix/ patterns. Push manually." 1
  fi

else
  # Remote URL does not match the expected URL
  abort_with_message "Warning: Remote URL does not match the expected repository. Aborting push." 2
fi
